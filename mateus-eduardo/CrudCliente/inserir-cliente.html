<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[RFS01] Inserir Cliente</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; }
        form { max-width: 800px; margin: auto; padding: 1em; border: 1px solid #ccc; border-radius: 1em; }
        fieldset { border: none; padding: 0; }
        legend h1 { margin: 0 0 .5em 0; font-size: 1.2em; }
        label { display: block; margin-top: 1em; font-weight: 600; }
        input, select { width: 100%; padding: .5em; margin-top: .5em; box-sizing: border-box; }
        small { color: #555; font-size: .8em; font-weight: normal; }
        .row { display: flex; gap: 1em; flex-wrap: wrap; }
        .col { flex: 1 1 240px; }
        button { margin-top: 1.5em; padding: .7em 1.2em; cursor: pointer; }
    </style>
</head>
<body>

<form action="#" method="post" id="formCadastroCliente">
    <fieldset>
        <legend><h1>[RFS01] Inserir Cliente</h1></legend>
        <p>Cadastro de novo cliente no sistema. O CPF deve ser válido (11 dígitos) e único.</p>

        <div class="row">
            <div class="col">
                <label for="cpf">*CPF</label>
                <input type="text" id="cpf" name="cpf" required maxlength="14" placeholder="000.000.000-00">
                <small>Formato ###.###.###-##. Deve ser único.</small>
            </div>

            <div class="col">
                <label for="nome_completo">*Nome completo</label>
                <input type="text" id="nome_completo" name="nome_completo" required maxlength="100" placeholder="Nome e sobrenome">
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label for="data_nasc">*Data de nascimento</label>
                <input type="date" id="data_nasc" name="data_nasc" required>
                <small>Formato dd/mm/aaaa.</small>
            </div>

            <div class="col">
                <label for="telefone">*Telefone</label>
                <input type="text" id="telefone" name="telefone" required maxlength="20" placeholder="(DD) 000-000">
                <small>Campo de telefone com DDD.</small>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label for="bairro">Bairro</label>
                <input type="text" id="bairro" name="bairro" placeholder="Bairro">
            </div>

            <div class="col">
                <label for="rua">Rua</label>
                <input type="text" id="rua" name="rua" placeholder="Rua / Avenida">
            </div>

            <div class="col">
                <label for="numero">Número</label>
                <input type="text" id="numero" name="numero" placeholder="123">
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label for="cep">CEP</label>
                <input type="text" id="cep" name="cep" maxlength="9" placeholder="00000-000">
            </div>

            <div class="col">
                <label for="status">*Status</label>
                <select id="status" name="status" required>
                    <option>Ativo</option>
                    <option>Inativo</option>
                </select>
            </div>

            <div class="col">
                <label for="data_cadastro">*Data de cadastro</label>
                <input type="text" id="data_cadastro" name="data_cadastro" readonly>
                <small>Somente leitura.</small>
            </div>
        </div>

        <button type="submit">Salvar Cliente</button>
        <button type="reset">Limpar</button>
    </fieldset>
</form>

<script>
    // máscara CPF
    const cpfInput = document.getElementById("cpf");
    cpfInput.addEventListener("input", function() {
        let v = cpfInput.value.replace(/\D/g, "").slice(0,11);
        if (v.length > 9) v = v.replace(/(\d{3})(\d{3})(\d{3})(\d{0,2})/, "$1.$2.$3-$4");
        else if (v.length > 6) v = v.replace(/(\d{3})(\d{3})(\d{0,3})/, "$1.$2.$3");
        else if (v.length > 3) v = v.replace(/(\d{3})(\d{0,3})/, "$1.$2");
        cpfInput.value = v;
    });

    // máscara telefone simples (DD) xxx-xxx
    const telInput = document.getElementById("telefone");
    telInput.addEventListener("input", function() {
        let v = telInput.value.replace(/\D/g,"").slice(0,9);
        if (v.length > 2) v = "(" + v.slice(0,2) + ") " + v.slice(2);
        if (v.length > 7) {
            const ddd = v.slice(1,3);
            const rest = v.replace(/^\(\d{2}\)\s?/, '');
            if (rest.length > 3) {
                telInput.value = "(" + ddd + ") " + rest.slice(0,3) + "-" + rest.slice(3,6);
            } else {
                telInput.value = "(" + ddd + ") " + rest;
            }
        } else {
            telInput.value = v;
        }
    });

    // máscara CEP 00000-000
    const cepInput = document.getElementById("cep");
    cepInput.addEventListener("input", function() {
        let v = cepInput.value.replace(/\D/g,"").slice(0,8);
        if (v.length > 5) v = v.replace(/(\d{5})(\d{0,3})/,"$1-$2");
        cepInput.value = v;
    });

    // preencher data cadastro
    const hoje = new Date();
    const dd = String(hoje.getDate()).padStart(2,'0');
    const mm = String(hoje.getMonth()+1).padStart(2,'0');
    const yyyy = hoje.getFullYear();
    document.getElementById("data_cadastro").value = dd + "/" + mm + "/" + yyyy;

    // validação final de cpf antes de enviar
    document.getElementById("formCadastroCliente").addEventListener("submit", function(e){
        const rawCPF = cpfInput.value.replace(/\D/g,"");
        if (rawCPF.length !== 11) {
            alert("CPF inválido. Deve ter 11 dígitos.");
            e.preventDefault();
        }
        // backend deve checar unicidade de CPF
    });
</script>

</body>
</html>
