<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[RFS12] Excluir Item de Estoque</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; }
        form { max-width: 700px; margin: auto; padding: 1em; border: 1px solid #ccc; border-radius: 1em; }
        fieldset { border: none; padding: 0; margin-bottom: 2em; }
        legend h1, legend h2 { margin: 0 0 .5em 0; font-size: 1.2em; }
        label { display: block; margin-top: 1em; font-weight: 600; }
        input { width: 100%; padding: .5em; margin-top: .5em; box-sizing: border-box; }
        .row { display: flex; gap: 1em; flex-wrap: wrap; }
        .col { flex: 1 1 240px; }
        button { margin-top: 1.5em; padding: .7em 1.2em; cursor: pointer; }
        .resumo-box { background:#f5f5f5; border:1px solid #ccc; border-radius:.5em; padding:1em; font-size:.9em; color:#333; }
        .alerta { color:#c00; font-size:.9em; font-weight:bold; margin-top:1em; display:none; }
        .confirm-check { display:flex; align-items:flex-start; gap:.5em; margin-top:1em; font-size:.9em; }
        .confirm-check input { width:auto; margin-top:.3em; }
    </style>
</head>
<body>

    <!-- localizar item -->
    <form action="#" method="get" id="formBuscarExcluir">
        <fieldset>
            <legend><h1>[RFS12] Excluir Item de Estoque</h1></legend>
            <p>Para excluir um item, o estoque dele precisa ser igual a 0. É exigida confirmação do usuário antes da exclusão.</p>

            <div class="row">
                <div class="col">
                    <label for="codigo_busca_excluir">Código Interno</label>
                    <input type="text" id="codigo_busca_excluir" name="codigo_busca_excluir" placeholder="Ex: 400-XYZ">
                </div>
            </div>

            <button type="submit">Carregar Item</button>
        </fieldset>
    </form>

    <!-- resumo / confirmação -->
    <form action="#" method="post" id="formExcluirItem">
        <fieldset>
            <legend><h2>Resumo do Item Selecionado</h2></legend>

            <div class="resumo-box" id="resumo_item">
                <strong>Item:</strong> Tomate Italiano 1kg (Cód 400-XYZ)<br>
                <strong>Categoria:</strong> Hortifruti<br>
                <strong>Unidade:</strong> KG<br>
                <strong>Status:</strong> Ativo<br>
                <strong>Estoque atual:</strong> <span id="estoque_atual_valor">0.00</span><br>
                <strong>Localização:</strong> Depósito A / Rua 3 / Prateleira 2
            </div>

            <div id="alerta_estoque" class="alerta">
                Não é possível excluir: o estoque precisa ser 0.
            </div>

            <div class="confirm-check">
                <input type="checkbox" id="confirma_exclusao">
                <label for="confirma_exclusao">
                    Confirmo que desejo excluir este item e entendo que essa ação é permanente.
                </label>
            </div>

            <button type="submit">Excluir Item</button>
            <button type="reset">Cancelar</button>
        </fieldset>
    </form>

    <script>
        document.getElementById('formExcluirItem').addEventListener('submit', function(e){
            // checar estoque atual
            const estoqueTxt = document.getElementById('estoque_atual_valor').innerText;
            const estoqueNum = parseFloat(estoqueTxt.replace(',','.')) || 0;
            const alerta = document.getElementById('alerta_estoque');
            const confirma = document.getElementById('confirma_exclusao').checked;

            if (estoqueNum > 0) {
                alerta.style.display = 'block';
                alert("Exclusão bloqueada: estoque precisa ser 0.");
                e.preventDefault();
                return;
            }

            if (!confirma) {
                alert("Você precisa marcar a confirmação antes de excluir.");
                e.preventDefault();
                return;
            }

            const certeza = confirm("Tem certeza? Esta exclusão é permanente.");
            if (!certeza) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>
